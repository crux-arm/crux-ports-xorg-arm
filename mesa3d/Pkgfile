# Description: Mesa 3D Graphics Library
# URL: http://www.mesa3d.org
# Arch Maintainer: CRUX-ARM System Team, devel at crux-arm dot nu
# Maintainer: CRUX Xorg Team, xorg-ports at crux dot nu
# Depends on: libdrm, xorg-makedepend, xorg-glproto, xorg-xextproto, xorg-dri2proto, xorg-libx11, xorg-xf86vidmodeproto, xorg-libxext, xorg-libxxf86vm, xorg-libxt, xorg-libxdamage, xorg-libpciaccess, expat, talloc, libxml2-python

name=mesa3d
version=8.0.4
release=2
source=(ftp://ftp.freedesktop.org/pub/mesa/$version/MesaLib-$version.tar.bz2
  mesa-8.0.3-llvm-3.1-fixes.patch)

build() {
  cd Mesa-$version

  patch -p 1 -i $SRC/mesa-8.0.3-llvm-3.1-fixes.patch

  ./configure --prefix=/usr \
              --with-driver=dri \
              --with-dri-drivers=swrast \
              --with-gallium-drivers=svga \
              --enable-gles1 \
              --enable-gles2 \
              --enable-glu

  make
  make DESTDIR=$PKG install
}
